<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Candlestick Chart</title>
    <!-- Plotly.js CDN -->
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <style>
        body {
            background-color: #202020;
            color: #fff;
            font-family: Arial, sans-serif;
        }
        #candlestickChart {
            width: 1000px;
            height: 1500px;
        }
    </style>
</head>
<body>
    <div id="candlestickChart"></div>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            // Get cryptocurrency name from URL parameter
            const urlParams = new URLSearchParams(window.location.search);
            const cryptoName = urlParams.get('name');

            // Fetch OHLC data for the selected cryptocurrency
            fetch(`https://api.coingecko.com/api/v3/coins/${cryptoName}/ohlc?vs_currency=usd&days=7`)
            .then(response => response.json())
            .then(data => {
                // Parse OHLC data
                const ohlcData = data.map(entry => ({
                    x: new Date(entry[0]), // Unix timestamp converted to JavaScript Date object
                    open: entry[1],
                    high: entry[2],
                    low: entry[3],
                    close: entry[4]
                }));

                // Extract OHLC values
                const x = ohlcData.map(entry => entry.x);
                const open = ohlcData.map(entry => entry.open);
                const high = ohlcData.map(entry => entry.high);
                const low = ohlcData.map(entry => entry.low);
                const close = ohlcData.map(entry => entry.close);

                // Plot candlestick chart using Plotly.js
                const trace = {
                    x: x,
                    close: close,
                    high: high,
                    low: low,
                    open: open,
                    type: 'candlestick',
                    xaxis: 'x',
                    yaxis: 'y',
                    name: 'Candlestick',
                    decreasing: {line: {color: '#FF0000'}}, // Solid color for decreasing candles
                    increasing: {line: {color: '#00FF00'}}  // Solid color for increasing candles
                };

                const layout = {
                    title: `${cryptoName.toUpperCase()} Candlestick Chart`,
                    xaxis: {
                        title: 'Date'
                    },
                    yaxis: {
                        title: 'Price (USD)'
                    },
                    paper_bgcolor: '#202020', // Dark mode background color
                    plot_bgcolor: '#202020', // Dark mode plot area color
                    font: {
                        color: '#fff' // Text color
                    },
                    width: 1500, // Set the width of the chart
                    height: 1200 // Set the height of the chart
                };

                Plotly.newPlot('candlestickChart', [trace], layout);
            })
            .catch(error => {
                console.error('Error fetching OHLC data:', error);
            });
        });
    </script>
</body>
</html>
